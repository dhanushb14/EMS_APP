{% extends "employee_information/base.html" %} {% block pageContent %}

<body>
  <div class="container mg-t">
    <div class="row">
      <div class="col">
        <h2 class="fw-bold mb-4">Employee List</h2>
      </div>
      <div class="col d-flex flex-column align-items-end">
        <!-- Button trigger modal -->
        <button
          type="button"
          class="btn btn-primary"
          data-bs-toggle="modal"
          data-bs-target="#exampleModal"
        >
          Create new team
        </button>
  
        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
       
            <div class="modal-content">
              <!-- Modal header -->
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Create New Team</h1>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <!-- end of modal header  -->
              <!-- Modal body -->
              <div class="modal-body">
                <form>
                  <div class="mb-3">
                    <label for="recipient-name" class="col-form-label"
                      >Name:</label
                    >
                    <input type="text" class="form-control" id="recipient-name" />
                  </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label"
                      >Scrum master:</label
                    >
                    <input class="form-control" id="message-text"></input>
                  </div>
                  <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Cancel
                </button>
                <button type="button" class="btn btn-primary">
                  Create
                </button>
                </form>
                <div class="table-responsive mt-5">
                  <div class="h2">Teams List</div>
                  <table class="table">
                      <thead>
                          <th>Name</th>
                          <th>Scrum Master</th>
                      </thead>
                      <tbody>
                          <tr>
                              <td>Next-Gen-Tech (NGT)</td>
                              <td>Dhanush Anand</td>
                          </tr>
                          <tr>
                              <td>Innovators</td>
                              <td>Vignesh S</td>
                          </tr>
                      </tbody>
                  </table>
                </div>
              </div>
              <!-- end of modal body -->
            </div>
          </div>
        </div>
        <!-- Modal end -->
      </div>
    </div>
  </div>
  <div class="container mt-5 mx-auto">
    <div class="card">
      <div class="table-responsive">
        <table class="table table-bordered">
          <colgroup>
            <col width="10%" />
            <col width="26%" />
            <col width="16%" />
            <col width="11%" />
          </colgroup>
          <thead>
            <tr class="table-secondary">
              <th class="text-center py-2">Employee Id</th>
              <th class="text-center py-2">Name</th>
              <th class="text-center py-2">Status</th>
              <th class="text-center py-2">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for employee in employees %}
            <tr>
              <td class="px-2 py-1 text-center">{{ employee.employee_id }}</td>
              <td class="px-2 py-1 text-center">{{ employee.employee_name }}</td>
              <td class="px-2 py-1 text-center my-auto">
                {% if employee.is_active == 1 %}
                <span
                  class="badge rounded-pill px-3"
                  style="background-color: blueviolet"
                  >Active</span
                >
                {% else %}
                <span class="badge bg-secondary rounded-pill px-3">Inactive</span>
                {% endif %}
              </td>
              <td class="px-2 py-1 text-center">
                <button
                  class="btn btn-secondary btn-sm edit-data"
                  type="button"
                  data-id="{{ employee.employee_id }}"
                  title="Edit"
                >
                  <i class="fa-solid fa-pen"></i>
                </button>
                <button
                  class="btn btn-danger btn-sm delete-data"
                  type="button"
                  data-id="{{ employee.employee_id }}"
                  title="Delete"
                >
                  <i class="fa-solid fa-trash"></i>
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
{% endblock pageContent %} {% block ScriptBlock %}
<script>
  $(function () {
    $(".edit-data").click(function () {
      uni_modal(
        "Edit Employee",
        "{% url 'manage_employees-page' %}?id=" + $(this).attr("data-id"),
        "modal-lg"
      );
    });

    $(".delete-data").click(function () {
      _conf("Are you sure to delete this employee?", "delete_employee", [
        $(this).attr("data-id"),
      ]);
    });
  });

  function delete_employee($id) {
    start_loader();
    $.ajax({
      headers: {
        "X-CSRFToken": "{{csrf_token}}",
      },
      url: "{% url 'delete-employee' %}",
      method: "POST",
      data: {
        id: $id,
      },
      dataType: "json",
      error: (err) => {
        console.log(err);
        alert_toast("An error occurred.", "error");
        end_loader();
      },
      success: function (resp) {
        if (typeof resp == "object" && resp.status == "success") {
          location.reload();
        } else {
          alert_toast("An error occurred.", "error");
          end_loader();
        }
      },
    });
  }
</script>
{% endblock ScriptBlock %}
